<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ã‚«ãƒŠãƒªã‚¢é€šä¿¡ï½œé…å¸ƒç”¨PDF</title>

<style>
@page { size: A4; margin: 10mm; }

:root{
  --paper:#fffdf7;
  --ink:#1f2937;
  --muted:#6b7280;
  --line:#e5e7eb;
  --sun:#ef4444;
  --sat:#3b82f6;
}

*{ box-sizing:border-box; }

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Hiragino Kaku Gothic ProN","Noto Sans JP",system-ui,sans-serif;
  background:#f3f4f6;
  color:var(--ink);
}

/* ===== ç”»é¢ç”¨æ“ä½œãƒãƒ¼ ===== */
.toolbar{
  position:sticky; top:0;
  background:#fff;
  border-bottom:1px solid var(--line);
  padding:10px;
  display:flex;
  justify-content:space-between;
  gap:10px;
  z-index:10;
}
.toolbar button{
  padding:8px 14px;
  border-radius:12px;
  border:1px solid var(--line);
  background:#fff;
  font-weight:800;
}
.toolbar button.primary{
  background:#22c55e;
  color:#fff;
  border:none;
}

@media print{
  .toolbar{ display:none; }
  body{ background:#fff; }
}

/* ===== ç”¨ç´™ ===== */
.paper{
  width:190mm;
  min-height:277mm;
  margin:12px auto;
  background:var(--paper);
  border-radius:12px;
  position:relative;
  overflow:hidden;
  border:1px solid #eee;
}

/* ===== ãƒ˜ãƒƒãƒ€ãƒ¼ä»®ã‚¤ãƒ©ã‚¹ãƒˆ ===== */
.header-bg{
  position:absolute;
  top:0; left:0;
  width:100%;
  height:42mm;
}
.header-content{
  position:relative;
  padding:14mm 10mm 6mm;
  display:flex;
  align-items:center;
  gap:10px;
}
.logo{
  font-size:28px;
}
.title{
  font-size:26px;
  font-weight:900;
}
.subtitle{
  font-size:12px;
  color:var(--muted);
}

/* ===== ãŠçŸ¥ã‚‰ã› ===== */
.notice{
  margin:4mm 10mm 6mm;
  background:#fffbeb;
  border:2px solid #fde68a;
  border-radius:14px;
  padding:6mm;
  font-weight:800;
  color:#92400e;
}

/* ===== ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ ===== */
.calendar{
  margin:0 10mm;
  border:2px solid var(--line);
  border-radius:14px;
  overflow:hidden;
  background:#fff;
}

.dow{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  background:linear-gradient(#f8fafc,#fff);
}
.dow div{
  text-align:center;
  padding:6mm 0;
  font-weight:900;
}
.dow .sun{ color:var(--sun); }
.dow .sat{ color:var(--sat); }

.grid{
  display:grid;
  grid-template-columns:repeat(7,1fr);
}

.cell{
  min-height:26mm;
  padding:4mm;
  border-right:1px solid var(--line);
  border-bottom:1px solid var(--line);
}
.cell:nth-child(7n){ border-right:none; }
.cell.out{ background:#fafafa; color:#9ca3af; }

.day{
  font-weight:900;
  font-size:12px;
}

/* æ´»å‹•ãƒãƒƒãƒ— */
.act{
  margin-top:5mm;
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:6px 10px;
  border-radius:999px;
  font-weight:900;
  font-size:12px;
  background:#e0f2fe;
  border:1px solid rgba(0,0,0,.08);
}

/* ===== ãƒ•ãƒƒã‚¿ãƒ¼ä»®ã‚¤ãƒ©ã‚¹ãƒˆ ===== */
.footer-bg{
  position:absolute;
  bottom:0; left:0;
  width:100%;
  height:44mm;
}

/* ===== ãƒ•ãƒƒã‚¿ãƒ¼æ–‡å­— ===== */
.foot{
  position:relative;
  margin:6mm 10mm 0;
  font-size:11px;
  color:var(--muted);
  padding-bottom:46mm;
}
</style>
</head>

<body>

<div class="toolbar">
  <div><strong>ã‚«ãƒŠãƒªã‚¢é€šä¿¡ï¼ˆé…å¸ƒç”¨ï¼‰</strong></div>
  <div>
    <button id="backBtn">æˆ»ã‚‹</button>
    <button class="primary" onclick="window.print()">PDFå‡ºåŠ›</button>
  </div>
</div>

<div class="paper">

  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼èƒŒæ™¯ -->
  <svg class="header-bg" viewBox="0 0 800 160" preserveAspectRatio="none">
    <defs>
      <linearGradient id="g" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="#dbeafe"/>
        <stop offset="100%" stop-color="#ffffff"/>
      </linearGradient>
    </defs>
    <rect width="800" height="160" fill="url(#g)"/>
    <text x="60" y="90" font-size="36">ğŸ¤</text>
    <text x="110" y="95" font-size="42" font-weight="900" fill="#1f2937">ã‚«ãƒŠãƒªã‚¢é€šä¿¡</text>
  </svg>

  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼æ–‡å­— -->
  <div class="header-content">
    <div class="logo">ğŸ“…</div>
    <div>
      <div class="title" id="monthTitle">----</div>
      <div class="subtitle">æ”¾èª²å¾Œç­‰ãƒ‡ã‚¤ã‚µãƒ¼ãƒ“ã‚¹ æœˆé–“äºˆå®šè¡¨</div>
    </div>
  </div>

  <div class="notice">
    ğŸ“£ ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’ä½œæˆã—ã¾ã—ãŸï¼ã”å®¶åº­ã§ã®ç¢ºèªãƒ»æ²ç¤ºãƒ»å…±æœ‰ã«ã”åˆ©ç”¨ãã ã•ã„ã€‚
  </div>

  <div class="calendar">
    <div class="dow">
      <div class="sun">æ—¥</div><div>æœˆ</div><div>ç«</div><div>æ°´</div>
      <div>æœ¨</div><div>é‡‘</div><div class="sat">åœŸ</div>
    </div>
    <div class="grid" id="grid"></div>
  </div>

  <div class="foot">
    â€» å†…å®¹ã¯å¤‰æ›´ã«ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br>
    â€» ã“ã®ãƒ—ãƒªãƒ³ãƒˆã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã¦ã„ã¾ã™ã€‚
  </div>

  <!-- ãƒ•ãƒƒã‚¿ãƒ¼èƒŒæ™¯ -->
  <svg class="footer-bg" viewBox="0 0 800 200" preserveAspectRatio="none">
    <rect width="800" height="200" fill="#ecfeff"/>
    <text x="120" y="150" font-size="36">âš½ï¸</text>
    <text x="200" y="155" font-size="36">ğŸ¨</text>
    <text x="280" y="150" font-size="36">ğŸ¤–</text>
    <text x="360" y="155" font-size="36">ğŸ¤</text>
  </svg>

</div>

<script>
(() => {
  const ACTS = {
    off:{l:"ãŠä¼‘ã¿",e:"ğŸ˜¶",c:"#e5e7eb"},
    sport:{l:"é‹å‹•",e:"ğŸƒ",c:"#dbeafe"},
    craft:{l:"å·¥ä½œ",e:"ğŸ¨",c:"#fde68a"},
    game:{l:"ãƒ«ãƒ¼ãƒ«ã‚²ãƒ¼ãƒ ",e:"ğŸ²",c:"#e9d5ff"},
    kara:{l:"ã‚«ãƒ©ã‚ªã‚±",e:"ğŸ¤",c:"#fecaca"},
    study:{l:"å­¦ç¿’",e:"ğŸ“š",c:"#bbf7d0"},
    planet:{l:"ãƒ—ãƒ©ãƒã‚¿ãƒªã‚¦ãƒ ",e:"ğŸª",c:"#bae6fd"},
    prog:{l:"ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°",e:"ğŸ¤–",c:"#e5e7eb"}
  };

  const p = new URLSearchParams(location.search);
  const y = Number(p.get("y")) || new Date().getFullYear();
  const m = Number(p.get("m")) || new Date().getMonth()+1;
  const key = `kanaria_calendar_v1:${y}-${String(m).padStart(2,"0")}`;

  document.getElementById("monthTitle").textContent = `${y}å¹´ ${m}æœˆ`;

  const data = JSON.parse(localStorage.getItem(key) || "{}");

  const first = new Date(y, m-1, 1);
  const last = new Date(y, m, 0);
  const start = 1 - first.getDay();

  const grid = document.getElementById("grid");

  for(let i=0;i<42;i++){
    const d = start + i;
    const inMonth = d>=1 && d<=last.getDate();
    const cell = document.createElement("div");
    cell.className = "cell" + (inMonth?"":" out");
    if(inMonth){
      const id = data[`${y}-${String(m).padStart(2,"0")}-${String(d).padStart(2,"0")}`];
      const act = ACTS[id];
      cell.innerHTML = `<div class="day">${d}</div>` + (act?`
        <div class="act" style="background:${act.c}">
          <span>${act.e}</span><span>${act.l}</span>
        </div>`:"");
    }
    grid.appendChild(cell);
  }

  document.getElementById("backBtn").onclick = ()=>history.back();
})();
</script>

</body>
</html>
